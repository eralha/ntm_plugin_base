var services=angular.module("appServices",[]);services.factory("dataService",["$http","$q",function(a,b){return this.getData=function(a){var c=b.defer();return a.nonce=window.nonces[a.action],jQuery.post(ajaxurl,a,function(a){c.resolve(angular.fromJson(a))}),c.promise},this}]);var candidaturas=angular.module("appCandidaturas",["appServices"]);candidaturas.directive("dirListaCandidaturas",["$rootScope","$injector","$filter","$sce",function(a,b,c,d){return{restrict:"C",templateUrl:window.pluginsDir+"/templates/backend/dir_lista_candidaturas.php",compile:function(a,b){return function(a,b,c){}}}}]),candidaturas.controller("listaCandidaturasController",["$scope","$rootScope","dataService","$filter",function(a,b,c,d){a.state="todos",a.candidaturas=[],a.pluginsDir=window.pluginsDir;var e=window.location.href,f="&idcandidatura=";if(-1!=e.indexOf(f)){var g=String(window.location).split(f);g=g[g.length-1],a.candidaturaSelectedId=g}a.$watch("state",function(b,c){a.candidaturas=[],"todos"==b&&a.getMessages(),"arquivo"==b&&a.getArquivo()}),a.setState=function(b){a.state=b,a.candidaturaSelectedId&&(a.candidaturaSelectedId=null,a.getMessages())},a.filtraCandidaturas=function(){a.candidaturas=angular.copy(a.dataSet),""!=a.filtro_oferta_id&&(console.log(a.filtro_oferta_id),a.candidaturas=d("filter")(a.candidaturas,{iIDPost:parseInt(a.filtro_oferta_id)},!0))},a.getOfertasEmprego=function(){c.getData({action:"getOfertasEmprego"}).then(function(b){a.ofertasEmprego=b})},a.getOfertasEmprego(),a.getMessages=function(){c.getData({action:"getCandidaturas"}).then(function(b){a.dataSet=b,a.candidaturas=angular.copy(b),a.currentPage=0,a.candidaturaSelectedId&&(a.candidaturas=d("filter")(a.candidaturas,{iIDCandidatura:parseInt(a.candidaturaSelectedId)},!0)),console.log(a.candidaturaSelectedId,a.candidaturas)})},a.getArquivo=function(){c.getData({action:"getArquivoCandidaturas"}).then(function(b){a.candidaturas=b,a.currentPage=0})},a.deleteCandidatura=function(b){for(var d=0;d<a.candidaturas.length;d++)a.candidaturas[d].iIDCandidatura==b&&(a.candidaturas[d].delleting=!0);c.getData({action:"deleteCandidatura",msgId:b}).then(function(b){1==b&&"todos"==a.state&&a.getMessages(),1==b&&"arquivo"==a.state&&a.getArquivo()})},a.arquivarCandidatura=function(b){for(var d=0;d<a.candidaturas.length;d++)a.candidaturas[d].iIDCandidatura==b&&(a.candidaturas[d].delleting=!0);c.getData({action:"arquivarCandidatura",msgId:b}).then(function(b){1==b&&"todos"==a.state&&a.getMessages(),1==b&&"arquivo"==a.state&&a.getArquivo()})},a.restaurarCandidatura=function(b){for(var d=0;d<a.candidaturas.length;d++)a.candidaturas[d].iIDCandidatura==b&&(a.candidaturas[d].delleting=!0);c.getData({action:"restaurarCandidatura",msgId:b}).then(function(b){1==b&&(a.getMessages(),a.state="todos")})},a.getDate=function(a){var b=new Date(1e3*a);return b.getDate()+"/"+(b.getMonth()+1)+"/"+b.getFullYear()+" - "+b.getHours()+":"+b.getMinutes()}}]);var directives=angular.module("appDirectives",[]);directives.directive("dirOpenPanel",["$rootScope","$injector","$filter","$sce",function(a,b,c,d){return{restrict:"A",compile:function(a,b){return function(a,b,c){var d=jQuery;d(b).click(function(){d(this).toggleClass("open")})}}}}]),directives.directive("dirListPager",["$rootScope","$injector","$compile","$filter",function(a,b,c,d){return{restrict:"EAC",compile:function(a,b){return function(a,b,c){var d=a,e=c.dirListPager;d.currentPage=0,d.pageSize=50;var f=d[e];d.$watch(function(){return d[e]},function(a){f=a.length}),console.log(d[e]),f=f.length||0,d.numberOfPages=function(){return Math.ceil(f/d.pageSize)},d.nextPage=function(){d.currentPage>=f/d.pageSize-1||(d.currentPage=d.currentPage+1,$("html, body").stop().animate({scrollTop:0},1e3,"swing"))},d.prevPage=function(){0!=d.currentPage&&(d.currentPage=d.currentPage-1,$("html, body").stop().animate({scrollTop:0},1e3,"swing"))}}}}}]);var app=angular.module("app",["appServices","appDirectives","appCandidaturas"]);app.filter("startFrom",function(){return function(a,b){return b=+b,a.slice(b)}}),angular.bootstrap(document,["app"]);